!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self)["divovk-js"]=e()}(this,(function(){"use strict";var t=Object.defineProperty,e=(e,i,s)=>((e,i,s)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s)(e,"symbol"!=typeof i?i+"":i,s);return class{constructor(t){e(this,"urlBlock",!1),e(this,"curState",{activity:[]}),e(this,"curActive",""),e(this,"cht",0),e(this,"chtLimit",500),e(this,"toastTime",0),e(this,"animList",{}),e(this,"toastId","#toast"),e(this,"toastClickE",""),e(this,"closeEvents",{}),e(this,"addListen",(()=>{window.addEventListener("popstate",(t=>{let e=window.location.hash,i=this.curState.activity,s=i.length,o=t.state,n=[];if(this.urlBlock)return void(e!=="#"+this.curActive&&this.hB(1));null!==o&&(n=t.state.activity);let a="open";if(null===o||n.length<s){let t=s-(null===o?0:n.length);a="close";for(let e=0;e<t;e++){let t=i[s-(1+e)],o=this.qS("#"+t).dataset.type;this.animList[`${o}_${a}`](t,this.curState),void 0!==this.closeEvents[t]&&this.closeEvents[t](i[s-2<0?0:s-2])}this.curActive=s-2<0?"":i[s-2]}else{let t=n[n.length-1];if("on"===this.qS("#"+t).dataset.noforw)return void this.hB();let e=this.qS("#"+t).dataset.type;this.animList[`${e}_${a}`](t,this.curState)}this.curState=null===o?{activity:[]}:o}))})),e(this,"navTo",(t=>{let e=this.qS("#"+t).dataset.type,i=this.cVar(this.curState);4==+e&&i.activity.length>0?(i.activity.pop(),i.activity.push(t),history.replaceState(i,null,`#${t}`)):(i.activity.push(t),history.pushState(i,null,`#${t}`)),this.animList[`${e}_open`](t,this.curState),this.curActive=t,this.curState=i})),e(this,"toast",((t,e,i=5e3,s=10)=>{s=1===s?0:s;let o={e:"terror",s:"tsuc",i:"tinfo",d:"tdel"},n=this.qS(this.toastId);this.delClass(n,n.getAttribute("tt")),this.addClass(n,o[t]),n.setAttribute("tt",o[t]),n.style.marginBottom=`${s}px`,this.qS(`${this.toastId} .toast_text`).textContent=e,this.addClass(n,"t_active"),clearTimeout(this.toastTime);let a=()=>{clearTimeout(this.toastTime),this.delClass(n,"t_active"),removeEventListener("click",a)};this.toastTime=setTimeout((()=>{this.delClass(n,"t_active"),removeEventListener("click",a)}),i),n.addEventListener("click",a)})),e(this,"hB",((t=-1)=>{history.go(t)})),e(this,"qS",(t=>document.querySelector(t)||document.createElement("d"))),e(this,"qSS",(t=>document.querySelectorAll(t))),e(this,"addClass",((t,e)=>{t.classList.add(e)})),e(this,"delClass",((t,e)=>{t.classList.remove(e)})),e(this,"cVar",(t=>JSON.parse(JSON.stringify(t)))),e(this,"dAlle",(t=>{let e=t instanceof Element?t:this.qS(t),i=e.cloneNode(!0);e.parentNode.replaceChild(i,e)})),e(this,"pTime",(()=>this.cht<+Date.now()&&(this.cht=+Date.now()+this.chtLimit,!0))),e(this,"initFun",(()=>{Element.prototype.qS=function(t){return this.querySelector(t)||document.createElement("d")},Element.prototype.addCl=function(t){this.classList.add(t)},Element.prototype.delCl=function(t){this.classList.remove(t)},Element.prototype.addClick=function(t){this.addEventListener("click",t||(()=>{}))},Element.prototype.addMouseUp=function(t){this.addEventListener("mouseup",t||(()=>{}))},Element.prototype.addMouseDown=function(t){this.addEventListener("mousedown",t||(()=>{}))},NodeList.prototype.addClick=function(t){this.forEach((e=>{e.addEventListener("click",(()=>{t(e)}))}))},NodeList.prototype.addMouseUp=function(t){this.forEach((e=>{e.addEventListener("mouseup",t||(()=>{}))}))},NodeList.prototype.addMouseDown=function(t){this.forEach((e=>{e.addEventListener("mousedown",t||(()=>{}))}))},Element.prototype.addChange=function(t){this.addEventListener("change",t||(()=>{}))},NodeList.prototype.addChange=function(t){this.forEach((e=>{e.addEventListener("change",t||(()=>{}))}))},Element.prototype.addInput=function(t){this.addEventListener("input",t||function(){})}})),t=t||{url_block:!1,limit_run:500,toast_id:"#toast"},this.chtLimit=t.limit_run,this.urlBlock=t.url_block,this.toastId=t.toast_id,this.addListen(),this.initFun()}}}));
